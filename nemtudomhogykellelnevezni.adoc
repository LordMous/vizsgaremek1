= API Modell Dokument√°ci√≥

== Tartalomjegyz√©k

* <<koezlemeny,Announcement>>
* <<cseveges,Chat>>
* <<kapcsolat,Contact>>
* <<kep,Img>>
* <<uzenet,Message>>
* <<felhasznalo,User>>
* <<kapcsolati-osszefoglalo,Kapcsolati √∂sszefoglal√≥>>

[[koezlemeny]]
== üì¢ Announcement

Rendszerk√∂zlem√©nyeket reprezent√°l, amelyeket felhaszn√°l√≥k k√ºldhetnek.

=== Mez≈ëk

[cols="1,1,2,2", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s | Megk√∂t√©sek
| id | Integer | Egyedi azonos√≠t√≥ | Automatikusan gener√°lt
| message | String | A k√∂zlem√©ny tartalma | K√∂telez≈ë, TEXT t√≠pus
| createdAt | LocalDateTime | L√©trehoz√°s id≈ëpontja | Alap√©rtelmezett az aktu√°lis id≈ë
| sender | User | A k√∂zlem√©nyt l√©trehoz√≥ felhaszn√°l√≥ | T√∂bb-egy kapcsolat
|===

=== Konstruktorok

`Announcement(String message, User sender)` ‚Äì L√©trehoz egy √∫j k√∂zlem√©nyt √ºzenettel √©s k√ºld≈ëvel.

[[cseveges]]
== üí¨ Chat

K√©t felhaszn√°l√≥ k√∂z√∂tti cseveg√©st reprezent√°l.

=== Mez≈ëk

[cols="1,1,2,2", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s | Megk√∂t√©sek
| id | Integer | Egyedi azonos√≠t√≥ | Automatikusan gener√°lt
| user1 | User | A cseveg√©s els≈ë r√©sztvev≈ëje | T√∂bb-egy kapcsolat, JSON ignore
| user2 | User | A cseveg√©s m√°sodik r√©sztvev≈ëje | T√∂bb-egy kapcsolat, JSON ignore
| messages | List<Message> | A cseveg√©s √ºzenetei | Egy-t√∂bb kapcsolat, JSON ignore
|===

[[kapcsolat]]
== üë• Contact

Felhaszn√°l√≥k k√∂z√∂tti kapcsolatokat reprezent√°l.

=== Mez≈ëk

[cols="1,1,2,2", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s | Megk√∂t√©sek
| id | Integer | Egyedi azonos√≠t√≥ | Automatikusan gener√°lt
| user | User | A kapcsolat tulajdonosa | T√∂bb-egy kapcsolat
| contactUser | User | A kapcsolatban l√©v≈ë m√°sik felhaszn√°l√≥ | T√∂bb-egy kapcsolat
| status | Status | A kapcsolat √°llapota | EnumType.STRING
|===

[[kep]]
== üñºÔ∏è Img

Rendszerbeli k√©peket reprezent√°l.

=== Mez≈ëk

[cols="1,1,2,2", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s | Megk√∂t√©sek
| id | Integer | Egyedi azonos√≠t√≥ | Automatikusan gener√°lt
|===

NOTE: Ez egy alapmodell, amely val√≥sz√≠n≈±leg tov√°bbi k√©phez kapcsol√≥d√≥ mez≈ëkkel b≈ëv√ºlne.

[[uzenet]]
== üì® Message

Cseveg√©sekben k√ºld√∂tt √ºzeneteket reprezent√°l.

=== Mez≈ëk

[cols="1,1,2,2", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s | Megk√∂t√©sek
| id | Integer | Egyedi azonos√≠t√≥ | Automatikusan gener√°lt
| chat | Chat | Az √ºzenethez tartoz√≥ cseveg√©s | T√∂bb-egy kapcsolat
| sender | User | Az √ºzenet k√ºld≈ëje | T√∂bb-egy kapcsolat
| message | String | Az √ºzenet tartalma |
| messageType | String | Az √ºzenet t√≠pusa (pl. "text", "image") |
| createdAt | Timestamp | Az √ºzenet k√ºld√©s√©nek ideje |
|===

[[felhasznalo]]
== üë§ User

A rendszer felhaszn√°l√≥it reprezent√°lja, hiteles√≠t√©si k√©pess√©gekkel.

=== Mez≈ëk

[cols="1,1,2,2", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s | Megk√∂t√©sek
| id | Integer | Egyedi azonos√≠t√≥ | Automatikusan gener√°lt
| email | String | Felhaszn√°l√≥ email c√≠me | K√∂telez≈ë, egyedi
| age | Integer | Felhaszn√°l√≥ √©letkora |
| userName | String | Felhaszn√°l√≥n√©v | K√∂telez≈ë, egyedi
| password | String | Titkos√≠tott jelsz√≥ |
| phoneNumber | String | Telefonsz√°m | K√∂telez≈ë, egyedi
| chatsAsUser1 | List<Chat> | Cseveg√©sek (1. r√©sztvev≈ëk√©nt) | Egy-t√∂bb kapcsolat
| chatsAsUser2 | List<Chat> | Cseveg√©sek (2. r√©sztvev≈ëk√©nt) | Egy-t√∂bb kapcsolat
| sentMessages | List<Message> | A felhaszn√°l√≥ √°ltal k√ºld√∂tt √ºzenetek | Egy-t√∂bb kapcsolat
| picture | String | Profilk√©p referenci√°ja |
| role | Role | Felhaszn√°l√≥ szerepk√∂re | EnumType.STRING
|===

=== UserDetails implement√°ci√≥

* Enged√©lyek: a `role` enum alapj√°n (`SimpleGrantedAuthority`)
* Biztons√°gi jelz≈ëk: minden alap√©rtelmez√©s szerint enged√©lyezve (`true`)
* Felhaszn√°l√≥n√©v: a `userName` mez≈ë alapj√°n

==== F≈ëbb met√≥dusok

* `getAuthorities()` ‚Äì visszaadja a felhaszn√°l√≥ szerepk√∂reit Spring Security enged√©lyk√©nt
* `getUsername()` ‚Äì visszaadja a `userName` mez≈ët

[[kozlemeny-controller]]
== üì¢ AnnouncementController

A K√∂zlem√©ny entit√°s REST v√©gpontjai.

=== V√©gpontok

[cols="1,1,2,2", options="header"]
|===
| M√≥dszer | √ötvonal | Le√≠r√°s | Megjegyz√©s
| GET | /announcements | √ñsszes k√∂zlem√©ny lek√©rdez√©se |
| POST | /announcements | √öj k√∂zlem√©ny l√©trehoz√°sa | message √©s senderId sz√ºks√©ges
| DELETE | /announcements/{id} | K√∂zlem√©ny t√∂rl√©se ID alapj√°n | Jogosults√°g ellen≈ërz√©s sz√ºks√©ges
|===

[[cseveges-controller]]
== üí¨ ChatController

A Cseveg√©s entit√°shoz tartoz√≥ REST v√©gpontok.

=== V√©gpontok

[cols="1,1,2,2", options="header"]
|===
| M√≥dszer | √ötvonal | Le√≠r√°s | Megjegyz√©s
| POST | /chats | √öj cseveg√©s ind√≠t√°sa k√©t felhaszn√°l√≥ k√∂z√∂tt | user1Id √©s user2Id mez≈ëk
| GET | /chats/user/{userId} | Egy adott felhaszn√°l√≥hoz tartoz√≥ cseveg√©sek lek√©rdez√©se |
| GET | /chats/existing/{user1Id}/{user2Id} | Megl√©v≈ë cseveg√©s lek√©rdez√©se k√©t felhaszn√°l√≥ k√∂z√∂tt |
|===

[[kapcsolat-controller]]
== üë• ContactController

Felhaszn√°l√≥k k√∂z√∂tti kapcsolatok kezel√©se.

=== V√©gpontok

[cols="1,1,2,2", options="header"]
|===
| M√≥dszer | √ötvonal | Le√≠r√°s | Megjegyz√©s
| GET | /contacts/{userId} | Felhaszn√°l√≥ kapcsolatai |
| POST | /contacts | √öj kapcsolat l√©trehoz√°sa | userId, contactUserId, status
| PUT | /contacts/{id} | Kapcsolat st√°tusz√°nak friss√≠t√©se |
| DELETE | /contacts/{id} | Kapcsolat t√∂rl√©se |
|===

[[uzenet-controller]]
== üì® MessageController

√úzenetek k√ºld√©se √©s lek√©rdez√©se.

=== V√©gpontok

[cols="1,1,2,2", options="header"]
|===
| M√≥dszer | √ötvonal | Le√≠r√°s | Megjegyz√©s
| POST | /messages | √öj √ºzenet k√ºld√©se | chatId, senderId, message, messageType
| GET | /messages/chat/{chatId} | Egy adott cseveg√©shez tartoz√≥ √ºzenetek lek√©rdez√©se |
|===

[[felhasznalo-controller]]
== üë§ UserController

Felhaszn√°l√≥k regisztr√°ci√≥ja, bejelentkez√©se √©s adataik lek√©rdez√©se.

=== V√©gpontok

[cols="1,1,2,2", options="header"]
|===
| M√≥dszer | √ötvonal | Le√≠r√°s | Megjegyz√©s
| POST | /users/register | √öj felhaszn√°l√≥ regisztr√°ci√≥ja |
| POST | /users/login | Bejelentkez√©s (JWT token visszat√©r√©se) |
| GET | /users/{id} | Felhaszn√°l√≥ adatainak lek√©rdez√©se ID alapj√°n |
| PUT | /users/{id} | Felhaszn√°l√≥ adatainak friss√≠t√©se |
|===

= DTO Dokument√°ci√≥

[[dto-section]]
== üì¶ Data Transfer Objects

[[user-dtos]]
=== üë§ Felhaszn√°l√≥ DTO-k

[[user-save-dto]]
==== UserSave

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| userName | String | Felhaszn√°l√≥n√©v (k√∂telez≈ë)
| email | String | Email c√≠m (k√∂telez≈ë)
| phoneNumber | String | Telefonsz√°m (k√∂telez≈ë)
| password | String | Jelsz√≥ (k√∂telez≈ë)
| age | Integer | √âletkor (k√∂telez≈ë)
|===

[source,java]
----
package asz.vizsgaremek.dto.user;

@Getter @Setter
public class UserSave {
    @NotNull private String userName;
    @NotNull private String email;
    @NotNull private String phoneNumber;
    @NotNull private String password;
    @NotNull private Integer age;
}
----

[[user-read-dto]]
==== UserRead

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| id | Integer | Felhaszn√°l√≥ azonos√≠t√≥
| (√ñr√∂k√∂lt mez≈ëk) | | UserSave √∂sszes mez≈ëje
|===

[source,java]
----
package asz.vizsgaremek.dto.user;

@Getter @Setter
public class UserRead extends UserSave {
    private Integer id;
}
----

[[user-list-item-dto]]
==== UserListItem

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| id | Integer | Felhaszn√°l√≥ azonos√≠t√≥
| name | String | Felhaszn√°l√≥ neve
| email | String | Email c√≠m
| phone | String | Telefonsz√°m
|===

[source,java]
----
package asz.vizsgaremek.dto.user;

@Getter @Setter @NoArgsConstructor
public class UserListItem {
    private Integer id;
    private String name;
    private String email;
    private String phone;
}
----

[[picture-read-dto]]
==== PictureRead

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| id | Integer | K√©p azonos√≠t√≥
| fullPath | String | K√©p teljes el√©r√©si √∫tja
|===

[source,java]
----
package asz.vizsgaremek.dto.user;

@Data
public class PictureRead {
    private Integer id;
    private String fullPath;
}
----

[[login-response-dto]]
==== LoginResponseDTO

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| token | String | JWT token
| userId | Integer | Bejelentkezett felhaszn√°l√≥ ID-ja
|===

[source,java]
----
package asz.vizsgaremek.dto.user;

@Getter @Setter
public class LoginResponseDTO {
    private String token;
    private Integer userId;
}
----

[[message-dtos]]
=== üì® √úzenet DTO-k

[[message-dto]]
==== MessageDTO

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| sender | String | K√ºld≈ë felhaszn√°l√≥ neve
| message | String | √úzenet tartalma
| createdAt | Timestamp | K√ºld√©s id≈ëpontja
| type | String | √úzenet t√≠pusa
|===

[source,java]
----
package asz.vizsgaremek.dto.user.message;

@Getter
public class MessageDTO {
    private String sender;
    private String message;
    private Timestamp createdAt;
    private String type;

    public MessageDTO(String sender, String message, Timestamp createdAt, String type) {
        this.sender = sender;
        this.message = message;
        this.createdAt = createdAt;
        this.type = type;
    }
}
----

[[socket-message-dto]]
==== SocketMessage

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| sender | String | K√ºld≈ë felhaszn√°l√≥
| content | String | √úzenet tartalma
| chatId | Integer | Cseveg√©s azonos√≠t√≥
| timestamp | LocalDateTime | K√ºld√©s id≈ëpontja
|===

[source,java]
----
package asz.vizsgaremek.dto.message;

@Getter @Setter
public class SocketMessage {
    private String sender;
    private String content;
    private Integer chatId;
    private LocalDateTime timestamp;
}
----

[[message-request-dto]]
==== MessageRequest

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| chatId | int | Cseveg√©s azonos√≠t√≥
| message | String | K√ºldend≈ë √ºzenet
|===

[source,java]
----
package asz.vizsgaremek.dto.user.message;

@Getter
public class MessageRequest {
    private int chatId;
    private String message;
}
----

[[contact-dtos]]
=== üë• Kapcsolat DTO-k

[[contact-dto]]
==== ContactDTO

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| id | Integer | Kapcsolat azonos√≠t√≥
| userId | Integer | Tulajdonos felhaszn√°l√≥ ID
| contactUserId | Integer | Kapcsolatban l√©v≈ë felhaszn√°l√≥ ID
| contactUserName | String | Kapcsolatban l√©v≈ë felhaszn√°l√≥ neve
| contactEmail | String | Kapcsolatban l√©v≈ë felhaszn√°l√≥ emailje
| status | String | Kapcsolat st√°tusza
| userName | String | Tulajdonos felhaszn√°l√≥ neve
|===

[source,java]
----
package asz.vizsgaremek.dto.contact;

@Getter @Setter
public class ContactDTO {
    private Integer id;
    private Integer userId;
    private Integer contactUserId;
    private String contactUserName;
    private String contactEmail;
    private String status;
    private String userName;

    public ContactDTO(Contact contact) {
        this.id = contact.getId();
        this.userId = contact.getUser().getId();
        this.contactUserId = contact.getContactUser().getId();
        this.contactUserName = contact.getContactUser().getUserName();
        this.contactEmail = contact.getContactUser().getEmail();
        this.status = contact.getStatus().name();
        this.userName = contact.getUser().getUserName();
    }
}
----

[[chat-dtos]]
=== üí¨ Cseveg√©s DTO-k

[[chat-dto]]
==== ChatDTO

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| id | Integer | Cseveg√©s azonos√≠t√≥
| user1Name | String | 1. felhaszn√°l√≥ neve
| user2Name | String | 2. felhaszn√°l√≥ neve
|===

[source,java]
----
package asz.vizsgaremek.dto.user.chat;

@Getter @Setter
public class ChatDTO {
    private Integer id;
    private String user1Name;
    private String user2Name;

    public ChatDTO(Integer id, String user1Name, String user2Name) {
        this.id = id;
        this.user1Name = user1Name;
        this.user2Name = user2Name;
    }
}
----

[[announcement-dtos]]
=== üì¢ K√∂zlem√©ny DTO-k

[[announcement-response-dto]]
==== AnnouncementResponse

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| id | Integer | K√∂zlem√©ny azonos√≠t√≥
| message | String | K√∂zlem√©ny tartalma
| createdAt | LocalDateTime | L√©trehoz√°s id≈ëpontja
| senderUsername | String | K√ºld≈ë felhaszn√°l√≥ neve
|===

[source,java]
----
package asz.vizsgaremek.dto.announcement;

@Getter @Setter
public class AnnouncementResponse {
    private Integer id;
    private String message;
    private LocalDateTime createdAt;
    private String senderUsername;

    public AnnouncementResponse(Integer id, String message, LocalDateTime createdAt, String senderUsername) {
        this.id = id;
        this.message = message;
        this.createdAt = createdAt;
        this.senderUsername = senderUsername;
    }
}
----

[[announcement-request-dto]]
==== AnnouncementRequest

[cols="1,2,3", options="header"]
|===
| Mez≈ë | T√≠pus | Le√≠r√°s
| message | String | K√∂zlem√©ny tartalma
|===

[source,java]
----
package asz.vizsgaremek.dto.announcement;

@Getter @Setter
public class AnnouncementRequest {
    private String message;
}
----

[[user-not-found-exception]]
== üö® UserNotFoundException

A felhaszn√°l√≥ nem tal√°lhat√≥ hib√°t reprezent√°l√≥ kiv√©tel oszt√°ly.

=== Oszt√°ly le√≠r√°sa

`asz.vizsgaremek.exception.UserNotFoundException` -
RuntimeException lesz√°rmazott, amely akkor dob√≥dik, amikor a rendszer nem tal√°lja a k√©rt felhaszn√°l√≥t.

=== Forr√°sk√≥d

[source,java]
----
package asz.vizsgaremek.exception;

public class UserNotFoundException extends RuntimeException {
}
----

=== Jellemz≈ëk

* `RuntimeException` lesz√°rmazott
* Parameter n√©lk√ºli konstruktor
* Alap√©rtelmezett hiba√ºzenettel rendelkezik
* Szerializ√°lhat√≥ (Serializable)

=== Haszn√°lati p√©lda

[source,java]
----
try {
    User user = userRepository.findById(userId)
        .orElseThrow(UserNotFoundException::new);
} catch (UserNotFoundException ex) {
    logger.error("Felhaszn√°l√≥ nem tal√°lhat√≥: " + userId);
    throw new ResponseStatusException(HttpStatus.NOT_FOUND, "User not found");
}
----

[[kapcsolati-osszefoglalo]]
== üîÑ Kapcsolati √∂sszefoglal√≥

[cols="1,1,2", options="header"]
|===
| Kapcsolat | T√≠pus | Le√≠r√°s
| Felhaszn√°l√≥ ‚Üí K√∂zlem√©ny | Egy-t√∂bb | Egy felhaszn√°l√≥ t√∂bb k√∂zlem√©nyt k√ºldhet
| Felhaszn√°l√≥ ‚Üî Cseveg√©s | T√∂bb-t√∂bb | K√©tf√©le kapcsolat (`user1` / `user2`) kereszt√ºl
| Felhaszn√°l√≥ ‚Üî Kapcsolat | √ñnmag√°ra hivatkoz√≥ | Felhaszn√°l√≥k egym√°ssal val√≥ kapcsolatai
| Cseveg√©s ‚Üí √úzenet | Egy-t√∂bb | Egy cseveg√©shez t√∂bb √ºzenet tartozhat
| Felhaszn√°l√≥ ‚Üí √úzenet | Egy-t√∂bb | Egy felhaszn√°l√≥ t√∂bb √ºzenetet k√ºldhet
|===